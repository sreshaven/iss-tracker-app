# Internation Space Station Tracker App

## Summary

NASA records the trajectory of the International Space Station through position and velocity data. However, there is an abundance of this data as they measure and record at four minute intervals across 15 days. The objective of this project is to develop a Flask app (located in `iss_tracker.py`) that will help in querying and sifting through the ISS trajectory dataset. Additionally, we will be using a Docker to help containerize the Flask app and make it easy to run and more portable. This application is important because it can save time in understanding the data and the Flask app can also help with calculating additional information with the data, such as the instantaneous speed of the ISS at a certain time. 

## About the ISS Trajectory Dataset

The `iss_tracker` Flask app uses a ISS trajectory dataset generated by ISS Trajectory Operations and Planning Officer (TOPO) flight controllers in the Mission Control Center at NASAâ€™s JSC and it is located at [this link](https://spotthestation.nasa.gov/trajectory_data.cfm) in both .txt and .xml formats. This dataset has information about the state vectors position {X, Y, Z} and velocity {X\_DOT, Y\_DOT, Z\_DOT} in units of km and km/s respectively of the ISS along with the Epoch, or time stamp in date time format. This data is recorded at four minute intervals over 15 days. The data is updated about three times a week so that the ISS Flight Control Team has accurate trajectory estimates, which is important since this dataset is used to maintain communication links and ensure that the ISS isn't at risk of any potential collisions.

## Flask App

The ISS Tracker Flask App, located in the `iss_tracker.py` script, helps with processing the .xml file with the ISS trajectory data into a dictionary and querying the position and velocity at specific epochs and calculating instantaneous speed of the ISS at a specific time. There are also routes to delete and update the dictionary with new data from NASA. The Flask app also has the ability to return real-time location information of the ISS. The end user uses routes (such as `/`, `/epochs`, `/epochs/<epoch>`, `epochs/<epoch>/speed`, etc.) to return certain information about the dataset.

### Instructions

In order to run the Flask app and query through the dataset using routes, open two SSH terminals on your machine so that you can run the Flask app on one terminal and query using the Flask app with the other one. There are four ways to run the Flask app. For methods 1-3, you will need Docker on your machine and for method 1, you will need to use Docker Compose as well.

_Method #1:_ The first method is to use the Docker Compose file in the repository to run the Flask app. In Terminal #1, first clone this repository to your local system using `git clone git@github.com:sreshaven/iss-tracker-app.git`. Next, change your current directory using `cd iss-tracker-app`. Now, run `docker-compose up` to start the Flask app with the settings provided in the `docker-compose.yml` file.

_Method #2:_ You can build a Docker image from the Dockerfile in the repository and run a container from this image. In Terminal #1, first clone this repository to your local system using `git clone git@github.com:sreshaven/iss-tracker-app.git`. Next, change your current directory using `cd iss-tracker-app`. Now, build the docker image locally from the Dockerfile using `docker build -t <username>/iss_tracker:midterm .` and replace the username field with your Docker Hub username. Run this image as a container using the command `docker run -it --rm -p 5000:5000 <username>/iss_tracker:midterm` and again replace username with your username and ensure that you map the ports in the command correctly. 

_Method #3:_ Another way of running the app is with a prebuilt image on Docker Hub. To use this, in Terminal #1, pull the image using `docker pull sreshaven/iss_tracker:midterm`. Now, run the image using `docker run -it --rm -p 5000:5000 sreshaven/iss_tracker:midterm`

_Method #4:_ You can run the Flask app directly from the script in the repository. In Terminal #1, first clone this repository to your local system using `git clone git@github.com:sreshaven/iss-tracker-app.git`. Next, change your current directory using `cd iss-tracker-app`. Now run the Flask app by running the command `flask --app iss_tracker --debug run`.

After completing one of the four methods, in Terminal #2, query through the dataset using the routes and examples described in the section below.

### Routes and Examples
While the flask app is running (in the background or in another terminal on the same machine) use these examples to guide you in querying through the dataset.

#### Route: /
To expose the all of the current ISS trajectory data points available, run `curl http://127.0.0.1:5000/`. Since this is a large dataset, to read only n first lines, run `curl http://127.0.0.1:5000/ | head -n D` and replace D with the number of lines you want to read. Below is an example of what `curl http://127.0.0.1:5000/ | head -n 30` looks like:
```
[
  {
    "EPOCH": "2023-048T12:00:00.000Z",
    "X": {
      "#text": "-5097.51711371908",
      "@units": "km"
    },
    "X_DOT": {
      "#text": "-4.5815461024513304",
      "@units": "km/s"
    },
    "Y": {
      "#text": "1610.3574036042901",
      "@units": "km"
    },
    "Y_DOT": {
      "#text": "-4.8951801207083303",
      "@units": "km/s"
    },
    "Z": {
      "#text": "-4194.4848049601396",
      "@units": "km"
    },
    "Z_DOT": {
      "#text": "3.70067961081915",
      "@units": "km/s"
    }
  },
  {
    "EPOCH": "2023-048T12:04:00.000Z",
```

#### Route: /epochs
To get a list of all of the Epochs or timestamps in the dataset currently, run `curl http://127.0.0.1:5000/epochs`. Each Epoch is formatted `year-dayThour:min:sec.000Z` and the day represents how many days it has been since January 1st, 2023. Below is an example of what the list that is returned can look like:
```
[
  "2023-048T12:00:00.000Z",
  "2023-048T12:04:00.000Z",
  "2023-048T12:08:00.000Z",
  "2023-048T12:12:00.000Z",
  "2023-048T12:16:00.000Z",
  "2023-048T12:20:00.000Z",
  "2023-048T12:24:00.000Z",
  "2023-048T12:28:00.000Z",
  "2023-048T12:32:00.000Z",
  "2023-048T12:36:00.000Z",
  "2023-048T12:40:00.000Z",
  "2023-048T12:44:00.000Z",
  "2023-048T12:48:00.000Z",
  "2023-048T12:52:00.000Z",
  "2023-048T12:56:00.000Z",
  "2023-048T13:00:00.000Z",
  "2023-048T13:04:00.000Z",
...
```

The limit and offset query parameters can be used to control how many epochs are printed out and the start point of the results. Below is an example of what `curl 'http://127.0.0.1:5000/epochs?limit=5&offset=2'` looks like:

> **_Note:_** You may not receive the same output if this specific command is run since the dataset may have updated with new Epochs.
```
[
  "2023-055T12:08:00.000Z",
  "2023-055T12:12:00.000Z",
  "2023-055T12:16:00.000Z",
  "2023-055T12:20:00.000Z",
  "2023-055T12:24:00.000Z"
]
```

#### Route: /epochs/\<epoch\>
To get the state vectors for position and velocity of the ISS at a specific Epoch from the data set, run `curl http://127.0.0.1:5000/epochs/<epoch>` and replace \<epoch\> with an Epoch from the list of Epochs for the dataset. This will return position {X, Y, Z} in units of km and velocity {X\_DOT, Y\_DOT, Z\_DOT} in units of km/s at that Epoch. Below is an example of what `curl http://127.0.0.1:5000/epochs/2023-063T12:00:00.000Z` looks like: 

> **_Note:_** You may not receive the same output if this specific command is run since the dataset may have updated with new Epochs.
```
{
  "EPOCH": "2023-063T12:00:00.000Z",
  "X": 2820.04422055639,
  "X_DOT": 5.03758258209994,
  "Y": -5957.89709645725,
  "Y_DOT": 0.7849431605754,
  "Z": 1652.06986538037,
  "Z_DOT": -5.71919131509608
}
```

#### Route: /epochs/\<epoch\>/speed
To get the instantaneous speed of the ISS for a specific Epoch in the dataset, run `curl http://127.0.0.1:5000/epochs/<epoch>/speed` and replace \<epoch\> with an Epoch from the list of Epochs for the dataset. Below is an example of what `curl http://127.0.0.1:5000/epochs/2023-063T12:00:00.000Z/speed` looks like:

> **_Note:_** You may not receive the same output if this specific command is run since the dataset may have updated with new Epochs.
```
{
  "units": "km/s",
  "value": 7.66162719643147
}
```

#### Route: /help
To get help about the routes for this app, run `curl http://127.0.0.1:5000/help` and below is an example of the output:
```
Usage: curl http://127.0.0.1:5000[ROUTE]

Routes:
        /                              (GET) return the entire data set
        /epoch                         (GET) return list of all Epochs in the data set
        /epochs?limit=int&offset=int   (GET) return modified list of Epochs given query parameters
                limit                          controls how many results are returned
                offset                         offsets the start point by an integer
        /epochs/<epoch>                (GET) return state vectors for a specific Epoch from the data set
        /epochs/<epoch>/speed          (GET) return instantaneous speed of the ISS for a specific Epoch
        /help                          (GET) return text about each route and their corresponding methods
        /delete-data                   (DELETE) delete all data from the dictionary object storing the data set
        /post-data                     (POST) reload the dictionary object with data from the web
        /comment                       (GET) return list of comments from ISS data
        /header                        (GET) return the header dictionary from the ISS dataset
        /metadata                      (GET) return the metadata dictionary from the ISS data
        /epochs/<epoch>/location       (GET) return lat, long, altitude, and geoposition for specified Epoch
        /now                           (GET) return location information about ISS for Epoch that is nearest to current time
```

#### Route: /delete-data
To delete all of ISS data from the dictionary object in the app, run `curl -X DELETE http://127.0.0.1:5000/delete-data`. Once this command is run and the data from the dictionary has been deleted, if any of the other GET method routes are used, the app will return empty lists and dictionaries since there will be no data. Below is the output message if completed successfully:
```
ISS Data has been deleted
```

#### Route: /post-data
To reload the dictionary object with most current ISS data from the dataset described above, use `curl -X POST http://127.0.0.1:5000/post-data` and below is an example of what the output looks like:
```
ISS Data has been reloaded
``` 

#### Route: /comment
To get the comments from the ISS dataset, run `curl http://127.0.0.1:5000/comment`. Below is an example of what the output should look like:
```
[
  "Units are in kg and m^2",
  "MASS=461235.00",
  "DRAG_AREA=1964.62",
  "DRAG_COEFF=2.50",
  "SOLAR_RAD_AREA=0.00",
  "SOLAR_RAD_COEFF=0.00",
  "Orbits start at the ascending node epoch",
  "ISS first asc. node: EPOCH = 2023-03-01T12:07:31.114 $ ORBIT = 2508 $ LAN(DEG) = 161.00612",
  "ISS last asc. node : EPOCH = 2023-03-16T11:13:47.515 $ ORBIT = 2740 $ LAN(DEG) = 85.61938",
  "Begin sequence of events",
  "TRAJECTORY EVENT SUMMARY:",
  null,
  "|       EVENT        |       TIG        | ORB |   DV    |   HA    |   HP    |",
  "|                    |       GMT        |     |   M/S   |   KM    |   KM    |",
  "|                    |                  |     |  (F/S)  |  (NM)   |  (NM)   |",
  "=============================================================================",
  "Crew06 Launch         061:05:34:13.000             0.0     427.0     408.8",
  "(0.0)   (230.6)   (220.7)",
...
```

#### Route: /header
To get the header from the ISS dataset, run `curl http://127.0.0.1:5000/header`. Below is an example of what the output should look like:
```
{
  "CREATION_DATE": "2023-060T20:39:58.746Z",
  "ORIGINATOR": "JSC"
}
```

#### Route: /metadata
To get the metadata from the ISS dataset, run `curl http://127.0.0.1:5000/metadata`. Below is an example of what the output should look like:
```
{
  "CENTER_NAME": "EARTH",
  "OBJECT_ID": "1998-067-A",
  "OBJECT_NAME": "ISS",
  "REF_FRAME": "EME2000",
  "START_TIME": "2023-060T12:00:00.000Z",
  "STOP_TIME": "2023-075T12:00:00.000Z",
  "TIME_SYSTEM": "UTC"
}
```

#### Route: /epochs/\<epoch\>/location
To get the latitude, longitude, altitude, and geoposition of the ISS at a specific Epoch from the data set, run `curl http://127.0.0.1:5000/epochs/<epoch>/location` and replace \<epoch\> with an Epoch from the list of Epochs for the dataset. This will return longitude and latitude in units of degrees and altitude in units of km at that Epoch. Additionally, the dictionary will also geoposition information such as country and state only if the ISS is above land. Below is an example of what `curl http://127.0.0.1:5000/epochs/2023-063T22:39:00.000Z/location` looks like to show the information provided if the ISS is above land:

> **_Note:_** You may not receive the same output if this specific command is run since the dataset may have updated with new Epochs.
```
{
  "ALTITUDE": {
    "units": "km",
    "value": 409.55446196577486
  },
  "GEOPOSITION": {
    "ISO3166-2-lvl4": "CN-NM",
    "country": "China",
    "country_code": "cn",
    "county": "East Ujimqin Banner",
    "region": "Xilingol League",
    "state": "Inner Mongolia",
    "town": "Alatanheli"
  },
  "LATITUDE": 45.384047833457544,
  "LONGITUDE": 115.70787982166564
}
```

Below is an example of the output for `curl http://127.0.0.1:5000/epochs/2023-075T11:42:00.000Z/location` which is when the ISS is over the ocean and there is no geoposition information:
```
{
  "ALTITUDE": {
    "units": "km",
    "value": 409.19536548946144
  },
  "GEOPOSITION": "No geolocation data available, ISS is over the ocean",
  "LATITUDE": 47.75437582760534,
  "LONGITUDE": -144.2825627134153
}
```

### Route: /now
To get location information for the ISS for the Epoch that is closest to the current time, use `curl http://127.0.0.1:5000/now`. The output will have the location information described in the route above as well as the Epoch for the data that is being displayed and the difference in time between the Epoch and the current time in seconds and the speed at that time in km/s. Below is an example of what `curl http://127.0.0.1:5000/now` looks like:
```
{
  "closest_epoch": "2023-063T23:27:00.000Z",
  "location": {
    "ALTITUDE": {
      "units": "km",
      "value": 423.5195417656696
    },
    "GEOPOSITION": {
      "ISO3166-2-lvl4": "AR-U",
      "country": "Argentina",
      "country_code": "ar",
      "state": "Chubut Province",
      "state_district": "Departamento Gastre"
    },
    "LATITUDE": -42.3982761683783,
    "LONGITUDE": -69.44749010174421
  },
  "speed": {
    "units": "km/s",
    "value": 7.650706766667962
  },
  "time_difference (sec)": -103.42451333999634
}
```
